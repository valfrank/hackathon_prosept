# hackathon_prosept
**DS part of a project for Hackathon Prosept Team 13**

## Задача
Разработка решения, которое автоматизирует процесс сопоставления товаров заказчика с размещаемыми товарами дилеров.

## Задачи в команде

- Елена: исследование задачи, подготовка плана работы, анализ данных, тестирование 
- Наталия: первичный анализ данных, подготовка данных к работе, тестирование 
- Валерия: написание кода, сборка скрипта, тестирование 

## Что было сделано
- Проведен предварительный анализ данных: обнаружены пропуски, дубликаты
- Проведена очистка текста:
  - удалены стоп-слова и знаки пунктуации
  - удалены цифры
  - строки разделены на слова, там где отсутствовали пробелы
  - обнаружены и исправлены опечатки
- Выделили дополнительные признаки - объем товара и цена 
- Предподготовка текста выделена в отдельные функции и python script 
- Провели векторизацию текста 2 способами tf-idf и с помощью мультиязычной модели LaBSE
- Близость текстов провели с помощью двух алгоритмов `cosine similarity` и библиотеки `FAISS`
- Для выбранных методов рассчитали метрику точности accuracy@k

## Метрика качества

В качестве метрики качества модели была выбрана `accuracy@k` 

Метрика показывает отношение количества запросов с подходящей рекомендацией среди k рекомендаций ко всем запросам 

Для полученого алгоритма получили:
+ **accuracy@5** = 0.95
+ **accuracy@3** = 0.91
+ **accuracy@7** = 0.96

## Решение 
В качестве решения предоставлен знеhon script model.py с функцией `get_recommendations(marketing_dealerprice: pd.DataFrame,
                        dealer_product_key: int, k=3)`

На вход функция получает индекс для запроса из таблицы с собранными от дилеров данными, обрабатвает название с помощью 
модуля `preprocess`, переводит в эмбеддинги с помощью модели *'sentence-transformers/LaBSE'* и находит топ-k ближайших 
соседей из корпуса названий от Просепт. 

На выход отправляется список рекомендованных 
индексов для таблицы с товарами от Просепт. 

